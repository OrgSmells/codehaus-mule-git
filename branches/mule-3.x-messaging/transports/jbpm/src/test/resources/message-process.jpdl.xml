<?xml version="1.0" encoding="UTF-8"?>

<process name="message"
	description="Generates a Mule message and processes its response."
	xmlns="http://jbpm.org/4.3/jpdl">

	<start name="start">
		<transition to="sendSynchronousMessage" />
	</start>

	<mule name="sendSynchronousMessage" 
		endpoint="vm://echo" payload="Message in a bottle."
		synchronous="true" var="echoResponse">
		<transition to="sendAsynchronousMessage" />
	</mule>

	<mule name="sendAsynchronousMessage" endpoint="test://queue" payloadSource="echoResponse"
		synchronous="false">
		<transition to="waitForResponse" />
	</mule>

	<state name="waitForResponse">
		<transition to="end" />
	</state>

	<end name="end" />

</process>
