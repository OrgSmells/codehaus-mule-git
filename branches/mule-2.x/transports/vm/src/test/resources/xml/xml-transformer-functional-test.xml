<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:mule="http://www.mulesource.org/schema/mule/core/2.0"
       xmlns:xml-transformer="http://www.mulesource.org/schema/mule/xml-transformer/2.0"
       xmlns:vm="http://www.mulesource.org/schema/mule/vm/2.0"
    xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
       http://www.mulesource.org/schema/mule/core/2.0 http://www.mulesource.org/schema/mule/core/2.0/mule.xsd
       http://www.mulesource.org/schema/mule/xml-transformer/2.0 http://www.mulesource.org/schema/mule/xml-transformer/2.0/mule-xml-transformer.xsd
       http://www.mulesource.org/schema/mule/vm/2.0 http://www.mulesource.org/schema/mule/vm/2.0/mule-vm.xsd">

    <vm:connector name="default"/>
    <vm:connector name="queue" queueEvents="true"/>

    <xml-transformer:dom-to-xml name="domToXml"/>
    <xml-transformer:xml-to-dom name="xmlToDom"/>

    <xml-transformer:jxpath-extractor name="jxpathExtractor" expression="/expression"/>

    <xml-transformer:object-to-xml name="objectToXml"/>
    <xml-transformer:xml-to-object name="xmlToObject"/>

    <xml-transformer:xslt name="xslt">
        <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
            <!-- test for this string in test -->
            <!-- Whenever you match any node or any attribute -->
            <xsl:template match="node()|@*">
                <!-- Copy the current node -->
                <xsl:copy>
                    <!-- don't copy inner contents -->
                </xsl:copy>
            </xsl:template>
        </xsl:stylesheet>
    </xml-transformer:xslt>

    <mule:endpoint name="xml-in" address="vm://xml-in" connector-ref="default"/>
    <mule:endpoint name="dom-in" address="vm://dom-in" connector-ref="default"/>

    <mule:endpoint name="xml-out" address="vm://xml-out" connector-ref="queue"/>
    <mule:endpoint name="xml-dom-out" address="vm://xml-dom-out" connector-ref="queue"/>
    <mule:endpoint name="dom-xml-out" address="vm://dom-xml-out" connector-ref="queue"/>

    <mule:model-seda name="xml transformer tests">

        <mule:service name="xml to ...">
            <mule:component class="org.mule.components.simple.BridgeComponent"/>
            <mule:inbound-router>
                <mule:endpoint ref="xml-in"/>
            </mule:inbound-router>
            <mule:outbound-router>
                <mule:multicasting-router>
                    <mule:endpoint ref="xml-out"/>
                    <mule:endpoint ref="xml-dom-out" transformers="xmlToDom"/>
                    <mule:endpoint ref="dom-in" transformers="xmlToDom"/>
                </mule:multicasting-router>
            </mule:outbound-router>
        </mule:service>

        <mule:service name="dom to xml">
            <mule:component class="org.mule.components.simple.BridgeComponent"/>
            <mule:inbound-router>
                <mule:endpoint ref="dom-in"/>
            </mule:inbound-router>
            <mule:outbound-router>
                <mule:multicasting-router>
                    <mule:endpoint ref="dom-xml-out" transformers="domToXml"/>
                </mule:multicasting-router>
            </mule:outbound-router>
        </mule:service>

    </mule:model-seda>

</beans>
